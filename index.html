<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billboard Sprite Generator</title>
    <link rel="stylesheet" href="style.css">
    <!-- Load Three.js and loaders -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/FBXLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/ColladaLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/PLYLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/VTKLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/TDSLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/MTLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <!-- For FBX loader dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/libs/fflate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/libs/inflate.min.js"></script>
</head>
<body>
    <div class="container">
    <h1>Billboard Sprite Generator</h1>
    
    <div class="drop-zone" id="dropZone">
    <div class="drop-message">Drag & Drop 3D Model Here</div>
    </div>
    
    <div class="controls">
    <div class="control-group">
    <label for="modelInput">Upload 3D Model:</label>
    <input type="file" id="modelInput" accept=".glb,.gltf,.obj,.stl,.fbx,.dae,.ply,.vtk,.3ds,.x,.mtl">
    <div class="format-info">Supported formats: GLB, GLTF, OBJ, STL, FBX, DAE (Collada), PLY, VTK, 3DS, X, MTL</div>
    </div>
    
    <div class="control-group">
    <label for="scale">Model Scale:</label>
    <input type="range" id="scale" min="0.1" max="10" step="0.1" value="1">
    <span id="scaleValue">1.0</span>
    </div>
    
    <div class="control-group">
    <label for="resolution">Resolution:</label>
    <select id="resolution">
    <option value="64">64x64</option>
    <option value="128">128x128</option>
    <option value="256" selected>256x256</option>
    <option value="512">512x512</option>
    </select>
    </div>
    
    <div class="control-group">
    <label for="steps">Steps (rotations):</label>
    <input type="number" id="steps" value="8" min="4" max="32">
    </div>
    </div>
    
    <div class="camera-controls">
    <h3>Camera Settings</h3>
    <div class="control-group">
    <label for="cameraDistance">Camera Distance:</label>
    <input type="range" id="cameraDistance" min="1" max="20" step="0.1" value="5">
    <span id="cameraDistanceValue">5.0</span>
    </div>
    
    <div class="control-group">
    <label for="initialAngle">Initial Angle (degrees):</label>
    <input type="range" id="initialAngle" min="0" max="359" step="1" value="0">
    <span id="initialAngleValue">0</span>
    </div>
    
    <div class="control-group">
    <label for="verticalAngle">Vertical Angle (degrees):</label>
    <input type="range" id="verticalAngle" min="-89" max="89" step="1" value="0">
    <span id="verticalAngleValue">0</span>
    </div>
    
    <div class="control-group">
    <label for="frameFill">Frame Fill %:</label>
    <input type="range" id="frameFill" min="50" max="95" step="1" value="80">
    <span id="frameFillValue">80</span>
    </div>
    </div>
    
    <div class="button-group">
    <button id="generateBtn">Generate Sprite</button>
    <button id="downloadBtn" disabled>Download Sprite</button>
    </div>
    
    <div id="statusMessage" class="status-message"></div>
    
    <div class="preview-container">
    <div class="preview-wrapper">
    <h3>3D Preview (mouse to rotate/zoom)</h3>
    <div id="modelPreview"></div>
    </div>
    
    <div class="preview-wrapper">
    <h3>Sprite Preview</h3>
    <div class="sprite-controls">
    <button id="prevFrame">Previous Frame</button>
    <button id="playPause">Play</button>
    <button id="nextFrame">Next Frame</button>
    </div>
    <canvas id="spritePreview" width="256" height="256"></canvas>
    </div>
    </div>
    
    <div class="output-container">
    <h3>Sprite Sheet</h3>
    <canvas id="outputCanvas" width="512" height="512"></canvas>
    </div>
    
    <div class="debug-info">
    <h3>Debug Information</h3>
    <div id="debugOutput">No model loaded yet</div>
    </div>
    </div>
    
    <!-- Load scripts -->
    <script src="spritegen.js"></script>
    <script src="main.js"></script>
    
    <!-- Debug script to check Three.js availability -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
    const debugOutput = document.getElementById('debugOutput');
    
    // Check if Three.js is loaded
    if (typeof THREE === 'undefined') {
    debugOutput.innerHTML += '<p style="color:red">ERROR: THREE is not defined!</p>';
    } else {
    debugOutput.innerHTML += '<p style="color:green">THREE is loaded correctly.</p>';
    
    // Check loaders
    const loaders = ['GLTFLoader', 'OBJLoader', 'STLLoader', 'FBXLoader', 'ColladaLoader', 'PLYLoader', 'VTKLoader', 'TDSLoader', 'MTLLoader'];
    loaders.forEach(loader => {
    if (typeof THREE[loader] === 'undefined') {
    debugOutput.innerHTML += `<p style="color:red">ERROR: THREE.${loader} is not defined!</p>`;
    } else {
    debugOutput.innerHTML += `<p style="color:green">THREE.${loader} is loaded correctly.</p>`;
    }
    });
    }
    });
    </script>
</body>
</html>